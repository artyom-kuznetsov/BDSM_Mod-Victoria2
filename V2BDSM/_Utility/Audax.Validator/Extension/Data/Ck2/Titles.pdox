(Validator HistoryTitles) = {
	Type = GroupValidator
	FriendlyName = "Titles"
	Description = "Including landed, minor, and religious titles"
	
	Validator = {
		Type = Default
		(FileGroup "common\minor_titles" "*.txt")
		ValidatorName = MinorTitles
	}
	Validator = {
		Type = Default
		(FileGroup "common\religious_titles" "*.txt")
		ValidatorName = ReligiousTitles
	}
	Validator = {
		Type = Default
		(FileGroup "common\landed_titles" "*.txt")
		ValidatorName = LandedTitles
	}
}

Global = {
	(Type.Enum MinorTitle) = { Import = { (FileGroup "common\minor_titles" "*.txt") SelectPath = "*\[L]" } }
}

Global = {
(Type NonLandTitleBase) = {
	Optional = { Left = "dignity" Right = Double }
	Optional = { Left = "opinion_effect" Right = Double }
	Optional = { Left = "monthly_salary" Right = Double }
	Optional = { Left = "monthly_prestige" Right = Double }
	Optional = { Left = "monthly_piety" Right = Double }
	Optional = { Left = "is_voter" Right = Bool }
	
	Optional = { Left = "allow" Right = CharTriggerFromChar }
	Optional = { Left = "gain_effect" Right = NonLandTitleBaseCommand }
	Optional = { Left = "lose_effect" Right = NonLandTitleBaseCommand }
	Optional = { Left = "retire_effect" Right = NonLandTitleBaseCommand }
	Optional = { Left = "death_effect" Right = NonLandTitleBaseCommand }
}
}

(Type NonLandTitleBaseCommand) = { ContextValidator = NonLandTitleBaseCommand }
(ContextValidator NonLandTitleBaseCommand) = {
	Inherits = CharCommand
	FromTarget = Char
}

(Type LandedTitles) = {
	HolySiteNoteProvValRunning
	
	(Ch Y N) = { Left = { Type = EmpireTitle } Right = EmpireTitleDef }
	(Ch Y N) = { Left = { Type = KingTitle } Right = KingTitleDef }
	(Ch Y N) = { Left = { Type = DukeTitle } Right = DukeTitleDef }
	(Ch Y N) = { Left = { Type = CountTitle } Right = CountTitleDef }
	(Ch Y N) = { Left = { Type = BaronTitle } Right = BaronTitleDef }
}

(Type MinorTitles) = {
	(Ch Y N) = { Left = { Type = String } Right = MinorTitleDef (CheckKey "*" Left IfNot = NoCheckKey) }
}

(Type MinorTitleDef) = {
	Inherits = NonLandTitleBase
	
	Optional = { Left = "counts_as_purple_born" Right = Bool }
	Optional = { Left = "realm_in_name" Right = Bool }
	Optional = { Left = "spouse_context" Right = Bool }
	Optional = { Left = "show_as_title" Right = Bool }
	Optional = { Left = "replace_order" Right = Bool }
	Optional = { Left = "patrician_heir" Right = Bool }
	Optional = { Left = "message" Right = Bool }
	Optional = { Left = "revoke_allowed" Right = Bool }
	Optional = { Left = "is_unique" Right = Bool }
	Optional = { Left = "is_high_prio" Right = Bool }
	Optional = { Left = "grant_limit" Right = NnDbl }
	Optional = { Left = "allowed_to_grant" Right = CharTrigger }
	Optional = { Left = "allowed_to_hold" Right = CharTriggerFromChar }
	Optional = { Left = "attribute" Right = Attribute }
	Optional = { Left = "ai_will_do" Right = CharFactorWeight }
	Optional = { Left = "revoke_trigger" Right = CharTriggerFromChar }
	Optional = { Left = "is_offmap_holder" Right = Bool }
	Optional = { Left = "offmap_power" Right = OffmapPower }
	
}

(Type ReligiousTitles) = {
	(Ch Y N) = {
		Left = { Type = String }
		Right = ReligiousTitleDef
		(CheckKey "*" Left IfNot = NoCheckKey)
		(CheckKey "expected_next_*" Left IfNot = NoCheckKey)
		(CheckKey "best_candidate_*" Left IfNot = NoCheckKey)
	}
}

(Type ReligiousTitleDef) = {
	Inherits = NonLandTitleBase
	
	Optional = { Left = "allowed_to_grant" Right = CharTrigger }
	Optional = { Left = "revoke_trigger" Right = CharTriggerFromChar }
	Single = { Left = "religion" Right = Religion }
	Single = { Left = "grant_limit" Right = PInt }
	Optional = { Left = "message" Right = Bool }
	Optional = { Left = "can_elect_head" Right = Bool }
	Optional = { Left = "realm_in_name" Right = Bool }
	Optional = { Left = "show_as_title" Right = Bool }
	Optional = { Left = "can_elect_head" Right = Bool }
	Optional = { Left = "revoke_allowed" Right = Bool }
}

(Type LandedTitleBase) = {
	Inherits = TitleBase
	
	FileExists = {
		Target = "[L]"
		Path = "gfx\flags\*.tga"
	}

	(If IfNot = NoTitleAdjCheckKey) = {
		(CheckKey "*_adj" Left IfNot = NoCheckKey)
	}
	
	TitleCapitalChecks

	(Single IfNot = "Titles.AllowDuplicateEntries") = { Left = "color" Right = { FloatColor Color } }
	(Optional If = "Titles.AllowDuplicateEntries") = { Left = "color" Right = { FloatColor Color } }
	Optional = { Left = "color2" Right = { FloatColor Color } }
	Optional = { Left = "culture" Right = Culture }
	Optional = { Left = "capital" Right = LandProvince }
	Optional = { Left = "creation_requires_capital" Right = Bool }
	Optional = { Left = "duchy_revokation" Right = Bool }
	Optional = { Left = "tribe" Right = Bool }
	Optional = { Left = "allow" Right = LandedCharTrigger }
	Optional = { Left = "dignity" Right = Int }
	Optional = { Left = "controls_religion" Right = Religion }
	(Ch Y N) = { Left = { Type = Religion } Right = NnDbl }
	(Ch Y N) = { Left = { Type = ReligionGroup } Right = NnDbl }
	Optional = { Left = "caliphate" Right = Bool }
	Optional = { Left = "monthly_income" Right = PInt }
	Optional = { Left = "can_be_claimed" Right = Bool }
	Optional = { Left = "can_be_usurped" Right = Bool }
	Optional = { Left = "usurpation_abides_allow" Right = Bool }
	Optional = { Left = "extra_ai_eval_troops" Right = Int }
	Optional = { Left = "hire_range" Right = Int }
}

(Type LandedCharTrigger) = { ContextValidator = LandedCharTrigger }
(ContextValidator LandedCharTrigger) = {
	Inherits = CharTrigger
	FromTarget = Title
}

(Type EmpireTitleDef) = {
	Inherits = LandedTitleBase
	
	(Ch Y N) = { Left = { Type = KingTitle } Right = KingTitleDef }
	(Ch Y N) = { Left = { Type = CountTitle } Right = CountTitleDef }

	Optional = { Left = "pirate" Right = Bool }
	Optional = { Left = "rebel" Right = Bool }
}

(Type TitleBase) = {
	(UniqueId IfNot = "Titles.AllowDuplicateEntries") = Left

	(Ck2TitleCheckKey IfNot = NoCheckKey)
	Optional = { Left = "male_names" Right = { (PdoList Y) = { Type = String } } }
	Optional = { Left = "female_names" Right = { (PdoList Y) = { Type = String } } }
	Optional = { Left = "primary" Right = Bool }
	Optional = { Left = "landless" Right = Bool }
	Optional = { Left = "foa" Right = Key }
	Optional = { Left = "title" Right = Key }
	Optional = { Left = "title_female" Right = Key }
	Optional = { Left = "location_ruler_title" Right = Bool }
	Optional = { Left = "dynasty_title_names" Right = Bool }
	Optional = { Left = "name_tier" Right = Tier }
	Optional = { Left = "short_name" Right = Bool }
	Optional = { Left = "mercenary_type" Right = MercenaryType }
	
	Optional = { Left = "holy_order" Right = Bool }
	Optional = { Left = "religion" Right = Religion }
	Optional = { Left = "independent" Right = Bool }
	Optional = { Left = "mercenary" Right = Bool }
	Optional = { Left = "modifier" Right = NormalModifier }
	Optional = { Left = "title_prefix" Right = Key }
	Optional = { Left = "strength_growth_per_century" Right = Double }
	# https://forum.paradoxplaza.com/forum/index.php?threads/the-validator-find-errors-quickly-and-with-minimal-pain.597480/page-132#post-23321879
	(Ch N Y) = { Left = "pentarchy" Right = { Bool Religion } }
	Optional = { Left = "has_top_de_jure_capital" Right = Bool }
	Optional = { Left = "top_de_jure_capital" Right = Bool }
	Optional = { Left = "purple_born_heirs" Right = Bool }
	(Optional If = V110) = { Left = "assimilate" Right = Bool }
	Optional = { Left = "graphical_culture" Right = GraphicalCultureType }
	
	Optional = { Left = "gain_effect" Right = TitledCharCommand }
	(Ch Y N) = { Left = { Type = Culture } Right = String }
	Optional = { Left = "coat_of_arms" Right = Untyped }
	
	(If If = V110) = {
		Optional = { Left = "pagan_coa" Right = Untyped }
		Optional = { Left = "used_for_dynasty_names" Right = Bool }
	}
}

(Type TitledCharCommand) = { ContextValidator = TitledCharCommand }
(ContextValidator TitledCharCommand) = {
	Inherits = CharCommand
	FromTarget = Char
}

(Type KingTitleDef) = {
	Inherits = LandedTitleBase

	(Ch Y N) = { Left = { Type = DukeTitle } Right = DukeTitleDef }
	(Ch Y N) = { Left = { Type = CountTitle } Right = CountTitleDef }
}

(Type DukeTitleDef) = {
	Inherits = LandedTitleBase
	(Ch Y N) = { Left = { Type = CountTitle } Right = CountTitleDef }
	Optional = { Left = "replace_captain_on_death" Right = Bool }

}

(Type CountTitleDef) = {
	Inherits = LandedTitleBase
	(Ch Y N) = { Left = { Type = BaronTitle } Right = BaronTitleDef }
	(Ch N Y If = V110) = { Left = "holy_site" Right = Religion HolySiteCounter }

}

(Type BaronTitleDef) = {
	Inherits = TitleBase
	
	Optional = { Left = "culture" Right = Culture }
	Optional = { Left = "religion" Right = Religion }
	(Ch N Y If = V110) = { Left = "holy_site" Right = Religion HolySiteCounter }
}





